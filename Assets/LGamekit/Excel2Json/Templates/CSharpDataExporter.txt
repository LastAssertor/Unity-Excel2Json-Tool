// CSharpDataExporter.cs
// This script is created by Excel2CSharp, please do not modify it.

using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEditor;
using System;
using System.IO;
using System.Text;


namespace LGamekit.Excel2Json
{



public static class CSharpDataExporter {

    [@MenuItem("Assets/Excel2Json/Export All CSharpData", false, {{.MenuItemOrder}})]
    public static void Export() {

        string input = EditorUtility.OpenFolderPanel("Export All CSharpData", "", "");
        if (string.IsNullOrEmpty(input)) {
            return;
        }
        
        var workbooks = WorkbookSerializer.LoadWorkbooks(input);
        if (workbooks.Count == 0) {
            return;
        }
        
        var output = Path.Combine(input, "Resources");
        output.CreateDirectory();

        string path = string.Empty;
        string json = string.Empty;

        Func<string, Sheet> getSheet = (string className) => {
            foreach(var workbook in workbooks) {
                Sheet result;
                if(workbook.Value.TryGetSheet(className, out result)) {
                    return result;
                }
            }
            return null;
        };

{{.WriteJsons}}

        AssetDatabase.Refresh();
        EditorUtility.RevealInFinder(output);
    }

}
}